## A query that uses joins to calculate total revenue generated by country

SELECT A. country,  COUNT (DISTINCT D.customer_id) as count_customers, SUM(E. amount) as revenue_generated
FROM country A
INNER JOIN city B ON A. country_id = B. country_id
INNER JOIN address C On B. city_id = C. city_id
INNER JOIN customer D ON C. address_id = D. address_id 
INNER JOIN payment E ON D. customer_id = E. customer_id
GROUP BY country
ORDER BY revenue_generated DESC
